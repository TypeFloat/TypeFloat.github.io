---
title: 计算机网络 —— VOL.5 数据链路层
tags: "计算机网络"
key: cn-5
sidebar:
  nav: cn
---

本系列是计算机网络学习的记录笔记，参考了中科大郑老师在B站上发布的[教学视频](https://www.bilibili.com/video/BV1JV411t7ow/)。文章主要介绍计算机网络中数据链路层的相关内容。<!--more-->

# 导论

数据链路层负责从一个节点通过链路将数据报发送到相邻的物理节点，是一种点到点的服务。节点指的是网络中的所有网络设备，主机、路由器、网桥和交换机等。链路包括有限链路、无线链路等。

链路层的服务在网络设备的网络适配器中实现服务，其提供的服务有：

- 数据封装与解封装：将传输层的数据报进行封装与解封装，数据链路层区分源地址与目标地址的标识是设备的MAC地址；
- 可靠的数据传递：提供错误检测（数据传输单元中包含EDC位，用于差错检测和纠正，差错检测算法包括奇偶校验、Internet校验和、循环冗余校验）和差错纠正，并不是所有的链路都提供该功能，例如光纤链路，其出错概率非常低，一般不提供可靠传输服务；
- 半双工和全双工的通路；
- 流量控制。

由于数据链路层已经偏硬件底层，所以介绍的相对简略，并且不再对物理层的知识进行记录。

# 多点访问协议

在网络设备之间的链路连接方式中，有点到点的方式，例如以太网交换机和主机之间的连接链路；也有共享线路的方式。当采用共享线路时，如果多个节点在同一时刻向链路中发送信号，则有可能产生冲突，因此需要多点访问协议用于控制。

理想的多点访问协议应当满足（假设贡献信道的带宽为Rbps）：

- 当一个节点要发送时，可以以R速率发送；
- 当M个节点要发送时，可以以R/M的平均速率发送；
- 完全分布的：
  - 没有特殊节点用于协调发送过程；
  - 没有时钟和时隙的同步；
- 协议本身简单。

根据实现方式，多点控制协议可以分为3类：

- 信道划分：对信道进行分片，分片方法有时分、频分、码分复用；
- 随机访问：允许冲突，由协议定义如何检测冲突以及冲突后如何进行恢复；
- 依次轮流。

使用信道划分的协议有TDMA（时分复用）、FFMA（频分复用）、CDMA（码分复用）。

使用随机访问的协议有时隙ALOHA、非时隙ALOHA、CSMA、CSMA/DA（以太网使用）、CSMA/CA（无线网使用）、线缆接入随机访问协议。

使用依次轮流的协议有轮训协议和令牌传递协议。

# LANs

## MAC地址和ARP

在数据链路层，网络设备使用MAC地址作为地址标识，MAC地址长48位，固化在适配器的ROM中（有时也可以通过软件设定），理论上全球任何两个网卡的MAC地址都不相同。

网络IP地址和链路MAC地址分离的原因：

- IP绑定的MAC地址可以更换；
- 物理网络可以支持IP协议以外的其他网络层协议；
- 不需要每次上电都重新加载设备的物理地址。

一台网络设备从IP地址到MAC地址的转换由ARP协议完成。ARP协议维护着ARP表，包含IP地址、MAC地址和TTL。

## 以太网

以前的以太网一般使用总线型的拓扑结构：

- 所有节点在一个碰撞域内，一次只允许一个节点发送；
- 可靠性差，如果介质破损，截面形成信号反射，发送节点会认为一直产生冲突。

现在通常使用星型拓扑结构：

- 交换机位于中心，其他网络设备与交换机相连；
- 每个节点以及相连的交换机端口使用独立的以太网协议，不与其他节点的发送产生碰撞。

以太网是一种无连接的不可靠的服务，采用二进制退避的CSMA/CD介质访问控制协议。

## 交换机

交换机是链路层的网络设备，对帧进行存储、检查帧头、根据目标MAC地址进行选择性转发。局域网中的主机有一个专用的直接与交换机的连接。交换机不需要进行配置，可以进行自学习。交换机通过自学习机制获取端口与主机MAC地址的对应关系，即转发表。

交换机和路由器的区别与联系：

- 都是存储转发设备，但层次不同；
- 都有转发表，交换机对应MAC、路由器对应IP；
- 路由器需要进行网络配置，交换机不需要。
